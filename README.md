pySHRA is an open-source package for simulating Second Harmonic Rotational Anisotropy (SHRA). SHRA is an optical technique which involves measuring the second harmonic response of a sample as a function of azimuthal rotation. In typical experiments, a pre-sample polarizer and post-sample analyzer are used to control the polarization direction of the incident fundamenntal and the output second harmonic. Canonical input-output polarization combinations include: p-in/p-out, p-in/s-out, s-in/p-out, s-in/s-out. pySHRA supports the sample may be isotropic (scalar $\epsilon$) or uniaxial ($\epsilon_{o}$, $\epsilon_{e}$) in nature. The incident medium is assumed to have isotropic linear optical properties (e.g., air, water). pySHRA uses a Green function based approach to calculate SH electric field amplitudes originating from two possible optical nonlinearities at the sample interface: (1) a 2nd-order surface susceptibility tensor $\chi^{(2)}(2\omega;\omega,\omega)$, and (2) a 3rd-order susceptibility tensor $\chi^{(3)}(2\omega;\omega,\omega,0)$ belonging to the incident medium. pySHRA was designed to facilitate analysis of SH from electrode-electrolyte interfaces formed from two centrosymmetric media. At present, pySHRA does not consider other nonlinearities such as electric quadrupole or magnetic dipole effects, or $\chi^{(3)}(2\omega;\omega,\omega,0)$ of the sample. 

The input parameters of pySHRA are: (1) the frequency of the fundamental $\omega$, (2) angle of incidence, (3) dielectric constants of the sample at $\omega$ and $2\omega$ (may be complex-valued), (4) dielectric constants of the incident medium at $\omega$ and $2\omega$, (5) the crystallographic point group of the sample surface, (6) a vector function describing the azimuthal dependence of the extraordinary axis $\hat{\boldsymbol{c}}$ (applicable to uniaxial crystals). pySHRA was originally designed to model SHRA of single-crystal samples prepared by epitaxial growth of a thin film on a single-crystal substrate. For this use case, the dielectric constants of the substrate must also be supplied in order to correct the top surface reflection/transmission coefficients for internal reflections occurring at the film-substrate interface. 

main outputs: dictionary of X2 fourier components broken down by input-output polarization

We highlight three major applications of pySHRA: (1) simulation of the azimuthal dependence of individual $\chi^{(2)}$ or $\chi^{(3)}$ elements, (2) calculation of the Fresnel coefficients that prefactor the $\chi^{(2)}$ or $\chi^{(3)}$ elements, and (3) performing a fit of  $\chi^{(2)}$ elements using experimental SHRA data. 
