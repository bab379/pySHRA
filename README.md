pySHRA is an open-source package for simulating Second Harmonic Rotational Anisotropy (SHRA). SHRA is an optical technique which involves measuring the second harmonic response of a sample as a function of azimuthal rotation $\phi$. In typical experiments, a pre-sample polarizer and post-sample analyzer are used to control the polarization direction of the incident fundamental and the measured output second harmonic. Canonical input-output polarization combinations include: p-in/p-out, p-in/s-out, s-in/p-out, s-in/s-out. pySHRA supports modeling of samples whose linear optical properties are isotropic (scalar $\epsilon$) or uniaxial ($\epsilon_{o}$, $\epsilon_{e}$) in nature. The incident medium is assumed to have isotropic linear optical properties (e.g., air, water). pySHRA uses a Green function based approach to calculate reflected SH electric field amplitudes originating from two possible optical nonlinearities at the sample interface: (1) a 2nd-order surface susceptibility tensor $\chi^{(2)}(2\omega;\omega,\omega)$, and (2) a 3rd-order susceptibility tensor $\chi^{(3)}(2\omega;\omega,\omega,0)$ belonging to the incident medium. pySHRA was designed to facilitate analysis of second harmonic generation from electrode-electrolyte interfaces formed from two centrosymmetric media. At present, pySHRA does not consider other nonlinearities such as electric quadrupole or magnetic dipole effects, or $\chi^{(3)}(2\omega;\omega,\omega,0)$ of the sample. 

The input parameters of pySHRA are: (1) the frequency of the fundamental $\omega$, (2) angle of incidence, (3) dielectric constants of the sample at $\omega$ and $2\omega$ (may be complex-valued), (4) dielectric constants of the incident medium at $\omega$ and $2\omega$, (5) the crystallographic point group of the sample surface, (6) a vector function describing the azimuthal dependence of the extraordinary axis $\hat{\boldsymbol{c}}$ (applicable to uniaxial crystals). pySHRA was originally designed to model SHRA of single-crystal samples prepared by epitaxial growth of a thin film on a single-crystal substrate. For this use case, (7) the dielectric constants of the substrate must also be supplied in order to correct the top surface reflection/transmission coefficients for internal reflections occurring at the film-substrate interface. During model setup, the user selects whether reflection/transmission coefficients are to be calculated assuming the system's linear optical properties are isotropic-isotropic, isotropic-uniaxial, or isotropic-uniaxial-uniaxial.  

A brief summary of the pySHRA workflow is as follows. Prior to running the model, the dielectric constants of the system must be read in. The dielectric constants of the incident medium (medium I) are retrieved from the *refractiveindex.info* database using the *refractiveindex* package. The dielectric constants of the sample (medium II or medium II + III) are retrieved from a user-supplied text file or using the *refractiveindex* package, according to the user's choice. Dielectric constant arrays are constructed for the media at $\omega$ and $2\omega$. In the example, the code is structured to easily perform a loop over a range of $\omega$ values and corresponding $\epsilon(\omega)$, if desired. In the next step of the startup sequence, media I, II, III are initialized as class instances with their respective point groups. Symbolic $\phi$-dependent $\chi^{(2)}(2\omega;\omega,\omega)$ and $\chi^{(3)}(2\omega;\omega,\omega,0)$ tensors consistent with the assigned point groups are generated and assigned to these objects. $Fresnel$ objects are also initialized for $\omega$ and $2\omega$, which contain functions for computing reflection/transmission coefficients. An $Evaluation$ object is also initialized and assigned the media and $Fresnel$ objects as attributes. This class contains functions for computing SH electric field amplitudes according to the Green function framework. After initialization, the wavelength sweep begins. The media objects are assigned their respective dielectric constants. Vectors $\hat{\boldsymbol{p}}$, $\hat{\boldsymbol{s}}$ are determined at $\omega$ and $2\omega$ for expressing the incident and reflected electric fields in medium I. According to the chosen method, the reflection/transmission coefficients for the I-II interface are computed, as well as the unit vectors for expressing the transmitted field in medium II. These results are packaged into various matrices defined in our publication, and are used to compute SH amplitudes for the canonical input-output combinations mentioned previously. Finally, the isotropic and anisotropic $cos(n\phi)$, $sin(n\phi)$ fourier components of the SH amplitudes are extracted. Model results are incorporated into four separate dictionaries: (1) SHRA fourier components for $\chi^{(2)}(2\omega;\omega,\omega)$, (2) SHRA fourier components for $\chi^{(3)}(2\omega;\omega,\omega,0)$, (3) various parameters related to the linear response at $\omega$, (4) various parameters related to the linear response at $2\omega$. These four dictionaries are saved to four separate pickle files ending in "X2_fourier", "X3_fourier", "fund_fresnel", "SH_fresnel". 

We highlight three major applications of pySHRA: (1) simulation of the azimuthal dependence of individual $\chi^{(2)}$ or $\chi^{(3)}$ elements, (2) calculation of the Fresnel coefficients that prefactor the $\chi^{(2)}$ or $\chi^{(3)}$ elements, and (3) performing a fit of $\chi^{(2)}$ elements using experimental SHRA data. We illustrate these applications in the provided examples, *polar_plots.py*, *fresnel_table.py*, and *SHRA_fit.py*. 
